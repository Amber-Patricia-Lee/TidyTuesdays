svn checkout https://github.com/rfordatascience/tidytuesday/trunk/data/2021/2021-01-05
install.packages("tidytuesdayR")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidytuesdayR)
library(tidyverse)
tuesdata <- tidytuesdayR::tt_load('2021-01-05')
tuesdata
transit_cost <- tuesdata$transit_cost
transit_cost
install.packages("countrycode")
library(countrycode)
destination = "ecb")
transit_cost %>%
mutate(country_name = countrycode(country, origin = "cowc",
destination = "ecb")) %>%
select(country, country_name)
transit_cost %>%
mutate(country_name = countrycode(country, origin = "iso2c",
destination = "ecb")) %>%
select(country, country_name)
transit_cost %>%
mutate(country_name = countrycode(country, origin = "iso2c",
destination = "iso.name.en")) %>%
select(country, country_name)
transit_cost %>%
mutate(country_name = countrycode(country, origin = "iso2c",
destination = "cow.name")) %>%
select(country, country_name)
transit_cost %>%
mutate(country_name = countrycode(country, origin = "ebc",
destination = "cow.name")) %>%
select(country, country_name)
transit_cost %>%
mutate(country_name = countrycode(country, origin = "ecb",
destination = "cow.name")) %>%
select(country, country_name)
transit_cost %>%
mutate(country_name = countrycode(country, origin = "ecb",
destination = "cow.name")) %>%
select(country, country_name) %>%
filter(is.na(country_name))
transit_cost
tuesdata
transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year) %>%
ggplot(aes(x = diff_year)) +
geom_hist()
transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year) %>%
ggplot(aes(x = diff_year)) +
geom_histogram()
transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year) %>%
ggplot(aes(x = diff_year)) +
geom_histogram(stat_bin = 10)
transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year) %>%
ggplot(aes(x = diff_year)) +
geom_histogram(aes(stat_bin = 10))
transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year) %>%
ggplot(aes(x = diff_year)) +
geom_histogram(aes(bins = 10))
transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year) %>%
ggplot(aes(x = diff_year)) +
geom_histogram(stat_bin(bins = 10))
transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year) %>%
ggplot(aes(x = diff_year)) +
geom_histogram()
transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year) %>%
ggplot(aes(x = diff_year)) +
geom_histogram(bins = 15)
transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year) %>%
filter(is.na(diff_year)) %>%
select(start_year, end_year, diff_year)
transit_cost
as.numeric("100.00%")
as.numeric("100.0")
transit_cost$tunnel_er
transit_cost$tunnel_per
transit_cost$tunnel_per[1][1:5]
transit_cost$tunnel_per[1]
transit_cost$tunnel_per[1][[1:5]]
transit_cost$tunnel_per[1][1]
transit_cost$tunnel_per[1][[1]]
substr(transit_cost$tunnel_per[1], 1, length(transit_cost$tunnel_per[1]) - 1)
substr(transit_cost$tunnel_per[1], 1, (length(transit_cost$tunnel_per[1]) - 1))
substr(transit_cost$tunnel_per[1], 1, 2)
length(transit_cost$tunnel_per[1])
length(transit_cost$tunnel_per[[1]])
transit_cost %>%
mutate(tunnel_dbl = substr(tunnel_per, 1,
length(tunnel_per)-1))
transit_cost %>%
mutate(tunnel_dbl = substr(tunnel_per, 1,
length(tunnel_per)-1)) %>%
select(tunnel_dbl, tunnel_per)
transit_cost %>%
mutate(tunnel_dbl = substr(tunnel_per, 1,
(length(tunnel_per)-2))) %>%
select(tunnel_dbl, tunnel_per)
transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year,
real_cost = as.numeric(real_cost))
transit_cost %>%
mutate(tunnel_dbl = str_remove(tunnel_per, "%"))
transit_cost %>%
mutate(tunnel_dbl = str_remove(tunnel_per, "%")) %>%
select(tunnel_dbl, tunnel_per)
transit_cost <- transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year,
real_cost = as.numeric(real_cost),
tunnel_per = as.numeric(str_remove(tunnel_per, "%")))
transit_cost
transit_cost %>%
ggplot(aes(x = real_cost, group_by = country)) +
geom_histogram() +
facet_wrap(~ country)
transit_cost %>%
ggplot(aes(x = real_cost)) +
geom_histogram() +
facet_wrap(~ country)
transit_cost %>%
ggplot(aes(x = real_cost, fill = country)) +
geom_histogram()
transit_cost %>%
mutate(country_name = countrycode(country, origin = "ecb",
destination = "ar5"))
transit_cost %>%
mutate(country_name = countrycode(country, origin = "ecb",
destination = "ar5")) %>%
select(country_name, country)
transit_cost %>%
mutate(country_name = countrycode(country, origin = "ecb",
destination = "region")) %>%
select(country_name, country)
transit_cost %>%
mutate(region = countrycode(country, origin = "ecb",
destination = "region")) %>%
mutate(region = case_when(country == "UK", "Europe & Central Asia")) %>%
select(country_name, country)
transit_cost %>%
mutate(region = countrycode(country, origin = "ecb",
destination = "region")) %>%
mutate(region = case_when(country == "UK", "Europe & Central Asia")) %>%
select(region, country)
transit_cost %>%
mutate(region = countrycode(country, origin = "ecb",
destination = "region")) %>%
mutate(region = case_when(country == "UK" ~ "Europe & Central Asia",
TRUE ~ region)) %>%
select(region, country)
transit_cost <- transit_cost %>%
mutate(region = countrycode(country, origin = "ecb",
destination = "region")) %>%
mutate(region = case_when(country == "UK" ~ "Europe & Central Asia",
TRUE ~ region)) %>%
select(region, country)
transit_cost
transit_cost <- tuesdata$transit_cost
transit_cost <- transit_cost %>%
mutate(region = countrycode(country, origin = "ecb",
destination = "region")) %>%
mutate(region = case_when(country == "UK" ~ "Europe & Central Asia",
TRUE ~ region))
transit_cost <- transit_cost %>%
mutate(start_year = as.numeric(start_year),
end_year = as.numeric(end_year),
diff_year = end_year - start_year,
real_cost = as.numeric(real_cost),
tunnel_per = as.numeric(str_remove(tunnel_per, "%")))
ggplot(data = transit_cost, aes(x = diff_year)) +
geom_histogram(bins = 15)
transit_cost %>%
filter(is.na(diff_year)) %>%
select(start_year, end_year, diff_year)
# NAs are from projects that are still in construction or start year not known
transit_cost %>%
ggplot(aes(x = real_cost, fill = region)) +
geom_histogram()
transit_cost %>%
ggplot(aes(x = real_cost, fill = region)) +
geom_histogram(position = "dodge")
transit_cost %>%
ggplot(aes(x = real_cost, fill = region)) +
geom_histogram() +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(region))
transit_cost %>%
filter(!is.na(region)) %>%
ggplot(aes(x = real_cost, fill = region)) +
geom_histogram() +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(region)) %>%
ggplot(aes(x = real_cost, fill = region)) +
geom_histogram() +
facet_wrap(~ region) +
labs(title = "distribution of costs by region")
ggplot(data = transit_cost, aes(x = diff_year)) +
geom_histogram(bins = 15) +
facet_wrap(~ region) +
labs(title = "distribution of project years")
ggplot(data = transit_cost, aes(x = diff_year, color = region)) +
geom_histogram(bins = 15) +
facet_wrap(~ region) +
labs(title = "distribution of project years")
ggplot(data = transit_cost, aes(x = diff_year, fill = region)) +
geom_histogram(bins = 15) +
facet_wrap(~ region) +
labs(title = "distribution of project years")
ggplot(transit_cost, aes(x = cost_km_millions, fill = region)) +
geom_histogram() +
facet_wrap(~ region)
ggplot(data = transit_cost, aes(x = length, y = real_cost)) +
geom_point(aes(fill = diff_year))
transit_cost %>%
filter(!is.na(country)) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(fill = diff_year))
transit_cost %>%
filter(!is.na(country)) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year))
transit_cost %>%
filter(!is.na(country)) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country) & is.na(diff_year)) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country) & !is.na(diff_year)) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country) & diff_year < 15) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country) & diff_year < 15 & real_cost < 50000) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country) & diff_year < 15 & real_cost < 50000) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year, alpha = 0.5)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country) & diff_year < 15 & real_cost < 50000) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country) & diff_year < 15 &
real_cost < 50000 & length < 100) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
ggplot(data = transit_cost, aes(x = diff_year, fill = region)) +
geom_histogram(bins = 15) +
facet_wrap(~ region) +
labs(title = "length of project")
transit_cost %>%
filter(is.na(diff_year)) %>%
select(start_year, end_year, diff_year)
# NAs are from projects that are still in construction or start year not known
transit_cost %>%
filter(!is.na(region)) %>%
ggplot(aes(x = real_cost, fill = region)) +
geom_histogram() +
facet_wrap(~ region) +
labs(title = "costs per project")
transit_cost %>%
filter(!is.na(country) & diff_year < 15 & length < 100) %>%
ggplot(aes(x = length, y = cost_km_millions)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country)) %>%
ggplot(aes(x = length, y = cost_km_millions)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
ggplot(transit_cost, aes(x = cost_km_millions, fill = region)) +
geom_histogram() +
facet_wrap(~ region) +
scale_x_continuous(limits = c(0, 3000))
ggplot(transit_cost, aes(x = cost_km_millions, fill = region)) +
geom_histogram() +
facet_wrap(~ region) +
scale_x_continuous(limits = c(0, 2000))
transit_cost %>%
filter(!is.na(region)) %>%
ggplot(aes(x = real_cost, fill = region)) +
geom_histogram() +
facet_wrap(~ region) +
labs(title = "costs per project") +
# scale to see distribution better, about a dozen observations excluded
scale_x_continuous(limits = c(0, 50000))
transit_cost %>%
filter(!is.na(region)) %>%
ggplot(aes(x = real_cost, fill = region)) +
geom_histogram() +
facet_wrap(~ region) +
labs(title = "costs per project") +
# scale to see distribution better, about a dozen observations excluded
scale_x_continuous(limits = c(0, 50000),
breaks = c(0, 20000, 40000))
transit_cost %>%
filter(!is.na(country) & diff_year < 15 &
real_cost < 50000 & length < 100) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country)) %>%
ggplot(aes(x = length, y = cost_km_millions)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country)) %>%
ggplot(aes(x = length, y = cost_km_millions)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region) +
scale_x_continuous(limits = c(0, 100))
transit_cost %>%
filter(!is.na(country) & diff_year < 15 &
real_cost < 50000 & length < 100) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country)) %>%
ggplot(aes(x = length, y = cost_km_millions)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region) +
scale_x_continuous(limits = c(0, 100))
transit_cost %>%
group_by(region, city) %>%
summarize(count = n())
transit_cost %>%
group_by(region, city) %>%
summarize(count = n(),
avg_length = mean(length),
avg_real_cost = mean(real_cost),
avg_kmpermil = mean(cost_km_millions)) %>%
transit_cost %>%
group_by(region, city) %>%
summarize(count = n(),
avg_length = mean(length),
avg_real_cost = mean(real_cost),
avg_kmpermil = mean(cost_km_millions))
summarize_transit_cost <- transit_cost %>%
group_by(region, city) %>%
summarize(count = n(),
avg_length = mean(length),
avg_real_cost = mean(real_cost),
avg_kmpermil = mean(cost_km_millions))
reg_transit_cost <- transit_cost %>%
group_by(region, city) %>%
summarize(count = n(),
avg_length = mean(length),
avg_real_cost = mean(real_cost),
avg_kmpermil = mean(cost_km_millions))
rm(summarize_transit_cost)
reg_transit_cost %>%
filter(count > 1) %>%
ggplot(aes(x = count, y = avg_kmpermil)) +
geom_point(color = region)
reg_transit_cost
reg_transit_cost %>%
filter(count > 1) %>%
ggplot(aes(x = count, y = avg_kmpermil)) +
geom_point(aes(color = region))
reg_transit_cost %>%
filter(count > 1) %>%
ggplot(aes(x = count, y = avg_kmpermil)) +
geom_point(aes(color = length))
reg_transit_cost %>%
filter(count > 1) %>%
ggplot(aes(x = count, y = avg_kmpermil)) +
geom_point(aes(color = avg_length))
reg_transit_cost %>%
filter(count > 1) %>%
ggplot(aes(x = avg_length, y = avg_kmpermil)) +
geom_point()
reg_transit_cost <- transit_cost %>%
group_by(region, city) %>%
summarize(count = n(),
avg_length = mean(length),
avg_real_cost = mean(real_cost),
avg_kmpermil = mean(cost_km_millions),
avg_diff = mean(diff_year))
reg_transit_cost %>%
filter(count > 1) %>%
ggplot(aes(x = avg_length, y = avg_kmpermil)) +
geom_point(color = avg_diff)
reg_transit_cost %>%
filter(count > 1) %>%
ggplot(aes(x = avg_length, y = avg_kmpermil)) +
geom_point(aes(color = avg_diff))
reg_transit_cost %>%
group_by(region) %>%
summarize(count = sum(count))
transit_cost %>%
group_by(region) %>%
summarize(count = sum(count),
avg_length = mean(length),
avg_real_cost = mean(real_cost),
avg_kmpermil = mean(cost_km_millions),
avg_diff = mean(diff_year))
transit_cost %>%
group_by(region) %>%
summarize(count = n(),
avg_length = mean(length),
avg_real_cost = mean(real_cost),
avg_kmpermil = mean(cost_km_millions),
avg_diff = mean(diff_year))
transit_cost %>%
group_by(region) %>%
summarize(count = n(),
avg_length = mean(length),
avg_real_cost = mean(real_cost),
avg_kmpermil = mean(cost_km_millions),
avg_diff = mean(diff_year)) %>%
ggplot(aes(x = count, y = avg_length))
transit_cost %>%
filter(!is.na(country) & diff_year < 15 &
real_cost < 50000 & length < 100) %>%
ggplot(aes(x = length, y = real_cost)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region)
transit_cost %>%
filter(!is.na(country)) %>%
ggplot(aes(x = length, y = cost_km_millions)) +
geom_point(aes(color = diff_year)) +
facet_wrap(~ region) +
scale_x_continuous(limits = c(0, 100))
